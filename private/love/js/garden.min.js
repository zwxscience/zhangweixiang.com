function Vector(A,B){this.x=A;this.y=B}Vector.prototype={rotate:function(C){var A=this.x;var B=this.y;this.x=Math.cos(C)*A-Math.sin(C)*B;this.y=Math.sin(C)*A+Math.cos(C)*B;return this},mult:function(A){this.x*=A;this.y*=A;return this},clone:function(){return new Vector(this.x,this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},subtract:function(A){this.x-=A.x;this.y-=A.y;return this},set:function(A,B){this.x=A;this.y=B;return this}};function Petal(B,D,C,F,E,A){this.stretchA=B;this.stretchB=D;this.startAngle=C;this.angle=F;this.bloom=A;this.growFactor=E;this.r=1;this.isfinished=false}Petal.prototype={draw:function(){var D=this.bloom.garden.ctx;var C,E,A,B;C=new Vector(0,this.r).rotate(Garden.degrad(this.startAngle));E=C.clone().rotate(Garden.degrad(this.angle));A=C.clone().mult(this.stretchA);B=E.clone().mult(this.stretchB);D.strokeStyle=this.bloom.c;D.beginPath();D.moveTo(C.x,C.y);D.bezierCurveTo(A.x,A.y,B.x,B.y,E.x,E.y);D.stroke()},render:function(){if(this.r<=this.bloom.r){this.r+=this.growFactor;this.draw()}else{this.isfinished=true}}};function Bloom(B,A,D,E,C){this.p=B;this.r=A;this.c=D;this.pc=E;this.petals=[];this.garden=C;this.init();this.garden.addBloom(this)}Bloom.prototype={draw:function(){var B,C=true;this.garden.ctx.save();this.garden.ctx.translate(this.p.x,this.p.y);for(var A=0;A<this.petals.length;A++){B=this.petals[A];B.render();C*=B.isfinished}this.garden.ctx.restore();if(C==true){this.garden.removeBloom(this)}},init:function(){var C=360/this.pc;var B=Garden.randomInt(0,90);for(var A=0;A<this.pc;A++){this.petals.push(new Petal(Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),Garden.random(Garden.options.petalStretch.min,Garden.options.petalStretch.max),B+A*C,C,Garden.random(Garden.options.growFactor.min,Garden.options.growFactor.max),this))}}};function Garden(B,A){this.blooms=[];this.element=A;this.ctx=B}Garden.prototype={render:function(){for(var A=0;A<this.blooms.length;A++){this.blooms[A].draw()}},addBloom:function(A){this.blooms.push(A)},removeBloom:function(B){var C;for(var A=0;A<this.blooms.length;A++){C=this.blooms[A];if(C===B){this.blooms.splice(A,1);return this}}},createRandomBloom:function(A,B){this.createBloom(A,B,Garden.randomInt(Garden.options.bloomRadius.min,Garden.options.bloomRadius.max),Garden.randomrgba(Garden.options.color.rmin,Garden.options.color.rmax,Garden.options.color.gmin,Garden.options.color.gmax,Garden.options.color.bmin,Garden.options.color.bmax,Garden.options.color.opacity),Garden.randomInt(Garden.options.petalCount.min,Garden.options.petalCount.max))},createBloom:function(C,D,A,E,B){new Bloom(new Vector(C,D),A,E,B,this)},clear:function(){this.blooms=[];this.ctx.clearRect(0,0,this.element.width,this.element.height)}};Garden.options={petalCount:{min:8,max:15},petalStretch:{min:0.1,max:3},growFactor:{min:0.1,max:1},bloomRadius:{min:8,max:10},density:10,growSpeed:1000/60,color:{rmin:128,rmax:255,gmin:0,gmax:128,bmin:0,bmax:128,opacity:0.1},tanAngle:60};Garden.random=function(A,B){return Math.random()*(B-A)+A};Garden.randomInt=function(A,B){return Math.floor(Math.random()*(B-A+1))+A};Garden.circle=2*Math.PI;Garden.degrad=function(A){return Garden.circle/360*A};Garden.raddeg=function(A){return A/Garden.circle*360};Garden.rgba=function(B,A,C,D){return"rgba("+B+","+A+","+C+","+D+")"};Garden.randomrgba=function(F,D,H,G,E,C,J){var A=Math.round(Garden.random(F,D));var K=Math.round(Garden.random(H,G));var I=Math.round(Garden.random(E,C));var B=5;if(Math.abs(A-K)<=B&&Math.abs(K-I)<=B&&Math.abs(I-A)<=B){return Garden.rgba(F,D,H,G,E,C,J)}else{return Garden.rgba(A,K,I,J)}};